package org.example.logic
import org.example.model.Meal
import org.example.utils.CsvParser
import org.example.utils.CsvParserImpl

class KetoDietMealHelper(private val parser: CsvParser) {

    private val suggestedMeals = mutableSetOf<String>()
    private var ketoMeals: List<Meal> = emptyList()

    fun loadMeals(csvPath: String) {
        val allMeals = parser.parse(csvPath)
        ketoMeals = allMeals.filter { it.carbs < 10 && it.fat > it.protein }.shuffled()
    }

    fun getKetoMeal(): Map<String, Any> {
        for (meal in ketoMeals) {
            if (meal.name !in suggestedMeals) {
                suggestedMeals.add(meal.name)
                return mapOf(
                    "Name" to meal.name,
                    "Description" to meal.description,
                    "Fat (g)" to meal.fat,
                    "Protein (g)" to meal.protein,
                    "Carbs (g)" to meal.carbs
                )
            }

        }
        return mapOf("Message" to "No more unique keto meals available.")
    }
}
